{"version":3,"sources":["..\\..\\..\\electron\\main\\window\\main.ts"],"sourcesContent":["import BaseWindow from \"./base\";\r\nimport { useMainWindowOptions } from \"./options\";\r\nimport { isDev } from \"../utils/is\";\r\nimport { join } from \"path\";\r\nimport { ClientContext } from \"../client\";\r\nimport { shell, app } from \"electron\";\r\n\r\nclass MainWindow extends BaseWindow {\r\n  public context: ClientContext\r\n\r\n  public webContentUrl: string\r\n\r\n  constructor(context: ClientContext) {\r\n    super()\r\n    this.context = context\r\n  }\r\n\r\n  public createWindow() {\r\n    this.createNativeWindow(useMainWindowOptions())\r\n  }\r\n\r\n  // 生命周期\r\n  public onBeforeCreate() {\r\n    this.webContentUrl = isDev\r\n      ? process.env.VITE_DEV_SERVER_URL\r\n      : `file://${join(process.env.DIST, 'index.html')}`\r\n  }\r\n  public onCreated() {\r\n    this.nativeWindow.setMenu(null)\r\n    this.show()\r\n\r\n    // 链接使用外部浏览器打开\r\n    this.webContent.setWindowOpenHandler((details) => {\r\n      shell.openExternal(details.url).then(() => {})\r\n\r\n      return {action: 'deny'}\r\n    })\r\n    this.webContent.on('will-navigate', (event, url) => {\r\n      event.preventDefault()\r\n\r\n      shell.openExternal(url).then(() => {})\r\n    })\r\n\r\n    this.webContent.on('did-finish-load', () => {\r\n      this.sendToRenderer('main-process-message', new Date().toLocaleString())\r\n    })\r\n  }\r\n  public onBeforeShow() { this.show() }\r\n  public onHidden() { }\r\n  public onShow() {\r\n    if (isDev) {\r\n      this.webContent.openDevTools()\r\n    }\r\n  }\r\n  public onBeforeClose() {}\r\n  public onClosed() {\r\n    this.webContent = null\r\n    this.nativeWindow = null\r\n\r\n    app.exit(0)\r\n  }\r\n\r\n  public focusWindow() {\r\n    if (this.isDestroyed) return\r\n\r\n    if (this.nativeWindow.isMinimized()) {\r\n      this.nativeWindow.restore()\r\n    }\r\n    if (!this.nativeWindow.isVisible()) {\r\n      this.nativeWindow.show()\r\n    }\r\n\r\n    this.nativeWindow.focus()\r\n  }\r\n}\r\n\r\nexport default MainWindow"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAAuB;AACvB,qBAAqC;AACrC,gBAAsB;AACtB,kBAAqB;AAErB,sBAA2B;AAE3B,MAAM,mBAAmB,YAAAA,QAAW;AAAA,EAKlC,YAAY,SAAwB;AAClC,UAAM;AACN,SAAK,UAAU;AAAA,EACjB;AAAA,EAEO,eAAe;AACpB,SAAK,uBAAmB,qCAAqB,CAAC;AAAA,EAChD;AAAA,EAGO,iBAAiB;AACtB,SAAK,gBAAgB,kBACjB,QAAQ,IAAI,sBACZ,cAAU,kBAAK,QAAQ,IAAI,MAAM,YAAY;AAAA,EACnD;AAAA,EACO,YAAY;AACjB,SAAK,aAAa,QAAQ,IAAI;AAC9B,SAAK,KAAK;AAGV,SAAK,WAAW,qBAAqB,CAAC,YAAY;AAChD,4BAAM,aAAa,QAAQ,GAAG,EAAE,KAAK,MAAM;AAAA,MAAC,CAAC;AAE7C,aAAO,EAAC,QAAQ,OAAM;AAAA,IACxB,CAAC;AACD,SAAK,WAAW,GAAG,iBAAiB,CAAC,OAAO,QAAQ;AAClD,YAAM,eAAe;AAErB,4BAAM,aAAa,GAAG,EAAE,KAAK,MAAM;AAAA,MAAC,CAAC;AAAA,IACvC,CAAC;AAED,SAAK,WAAW,GAAG,mBAAmB,MAAM;AAC1C,WAAK,eAAe,wBAAwB,IAAI,KAAK,EAAE,eAAe,CAAC;AAAA,IACzE,CAAC;AAAA,EACH;AAAA,EACO,eAAe;AAAE,SAAK,KAAK;AAAA,EAAE;AAAA,EAC7B,WAAW;AAAA,EAAE;AAAA,EACb,SAAS;AACd,QAAI,iBAAO;AACT,WAAK,WAAW,aAAa;AAAA,IAC/B;AAAA,EACF;AAAA,EACO,gBAAgB;AAAA,EAAC;AAAA,EACjB,WAAW;AAChB,SAAK,aAAa;AAClB,SAAK,eAAe;AAEpB,wBAAI,KAAK,CAAC;AAAA,EACZ;AAAA,EAEO,cAAc;AACnB,QAAI,KAAK;AAAa;AAEtB,QAAI,KAAK,aAAa,YAAY,GAAG;AACnC,WAAK,aAAa,QAAQ;AAAA,IAC5B;AACA,QAAI,CAAC,KAAK,aAAa,UAAU,GAAG;AAClC,WAAK,aAAa,KAAK;AAAA,IACzB;AAEA,SAAK,aAAa,MAAM;AAAA,EAC1B;AACF;AAEA,IAAO,gBAAQ;","names":["BaseWindow"],"file":"main.js"}